\documentclass[10pt,a4paper]{article}
\linespread{1.3}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\author{Andrew Rosen}
\title{The Sybil Attack From the Attacker's Perspective}   % Or The Attacker's View of The Sybil Attack
\begin{document}
\maketitle



%TODO IN THIS ORDER
%1) WRITE PAPER
%2) DO EXPERIMENTS FOR GRAPHS
%3) ADD EXPERIMENT RESULTS TO PAPER
%4) ADD REFERENCES
%5) MAKE UP SOME SLIDES
\begin{abstract}
This paper explores the feasibility of performing naive Sybil attacks that completely occlude healthy nodes from each other.
The vulnerability of Distributed Hash Tables to Sybil attacks and Eclipse attacks has been well known for some time.
However, these vulnerabilities has often been explored in a theoretical sense, assuming the attacker is a global adversary from the beginning, nigh-omniscient and omnipotent. 
This paper examines, from a analytical and practical perspective, how valid that assumption is.

We examine the amount of computational effort required to become a global adversary starting as a non-global adversary.
We do this by analyzing the amount of time it takes an attacker with a given IP to choose a port to obtain a desired hashkey, a process we call \emph{potatoing}.
We present potatoing to emphasize the ease of this attack, but also demonstrate potential non-security uses of potatoing that are beneficial to DHT load-balancing. 
\end{abstract}

\section{Introduction}
One of the key properties of structured peer-to-peer (P2P) systems is the lack of a centralized coordinator.
P2P systems remove the vulnerability of a single point of failure and and the susceptibility to a denial of service attack (cite original Sybil paper), but in doing so, open themselves up to new attacks.
Completely decentralized P2P systems are vulnerable to \textit{Eclipse attacks}, whereby an attacker completely occlude healthy nodes from one another.
This prevents them from communicating without being intercepted by the attacker.

One way to accomplish this attack is to perform a \emph{Sybil Attack} \cite{douceur2002sybil}.
In a Sybil attack, the attacker creates multiple malicious virtual nodes in order to disrupt the network.
If enough malicious nodes are injected into the system, the majority of the nodes will be occluded from one another, successfully performing an Eclipse attack.

Security analyses typically assumes an adversary using a Sybil is omniscient and can inject virtual nodes wherever he chooses in a reasonable amount of time. 
Our goal is to demonstrate how veracity of that assumption by doing analysis and simulations.

%Why am I doing this?
Sybil attacks represent a significant threat to the security of any distributed system.
Many of the analyses \cite{bauer2007low} on Tor \cite{dingledine2004tor} emphasize the vulnerability of Tor to the Sybil attack.
This threatens the anonymity of Tor users, particularly those living in countries with peculiar notions about personal privacy CITATION:  WHO USES TOR.

P2P systems like BitTorrent are essential to a wide variety of users.
BitTorrent, for instance, is the \textit{de facto} platform for distributing large files scalably among tens of thousands of clients.
An estimated 20 million peers use BitTorrent daily for sharing and retrieving Linux and BSD-based distros, offline copies of Wikipedia, and personal backup
Current research demonstrates  BitTorrent is vulnerable to the Sybil attack and a persistent attack disabling BitTorrent would e highly detrimental to many users, but especially developers and system administrators \footnote{Perhaps the only reason that BitTorrent hasn't be attacked in such a way as to render it unusable is that those capable of doing so rely heavily upon it.  A sobering thought, since BitTorrent is under an active Sybil attack.}.


There have been many suggestions on how to defend against Sybil attack, but there is no agreed upon ``silver bullet'' among researchers that should be implemented for every distributed application \cite{levine2006survey}
Part of this is surely influenced by the only surefire way to defend against a Sybil attack is to introduce a trusted authority to certify and/or bind identities.
This solution potentially removes the Sybil attack, but reintroduces vulnerabilities to denial of service attacks, bringing us full circle.
Another reason is that there is no single solution for all platforms is that not every solution is compatible with each distributed platform.


Despite the threat represented by the Sybil attack and the research done on the subject, little research has been done from the perspective of an adversary.
We sought to rectify this, both to reemphasize the threat of the Sybil attack, but also because this examination introduces some interesting graph theory problems.

Our work presents the following contributions:
\begin{itemize}
    \item We first discuss the mechanics of performing a Sybil attack and analyze the theoretical effort needed to bring to bear to perform the Sybil attack.
    \item We present our simulations which show how quickly even a naive and inefficient Sybil attack can compromise a system.  We also discuss how a more intelligent attack can be geared to each of the more popular DHT topologies.
    \item We analyze an interesting graph coloring problem that an attacker needs to solve if the attack is to remain undetected.
    \item We discuss the implications of our work, specifically how the techniques we developed to perform the attack can be used for automatic load balancing.

\end{itemize}

\section{Formal Analysis}


\subsection{Assumptions}
In our analysis we make a few assumptions. 
First, we look primarily at fully distributed systems that assign nodes identifiers using a cryptographic hash function, DHTs.
Well-known hash functions include MD5 \cite{md5} and SHA1 \cite{sha1}.
Cryptographic hash functions work by mapping some input value to an $m$-bit key or identifier.
Keys generated by the hash function are assumed to be evenly distributed and random \cite{bellare2004hash}. 

In distributed hash tables, $m$ is a large value, in order to avoid collisions between mapped inputs, unintentional or otherwise. 
An $m geq 128$ is typical, with $m = 160$ being the most popular choice.


Our second assumption is that node IDs are generated by hashing their IP address and port.
The majority of DHTs present this method as the means of generating node IDs, and although other methods exist\footnote{In Mainline DHT, used by BitTorrent, it appears you can choose your own ID at ``random.''}, they are not nearly as prevalent.

We also assume that nodes store verify that a node's advertised IP address and port generate the advertised node ID. 
Relaxing the latter assumptions would  make the Sybil attack trivial. If the attacker does not have to search for values, he can make up any needed key on the fly and falsely advertise it to the network unchallenged.

Consider an attacker operating under these assumptions who wants to inject a malicious node in between two victims.
The attacker must search for a valid IP and port combination under his control that generates a hash key that lies between the two victims's keys, a process we will call \textit{potatoing}.
The attackers ability to compromise the network depends on what IP address and ports he has available.



\subsection{Analysis}

Suppose we have a DHT with $n$ members in it, with $m-bit$ node IDs between $[0,2^{m})$.
We can assume that, for a large enough $n$, node IDs will be close to evenly distributed across the keyspace, meaning there will be $\approx \frac{2^{m}}{N}$ key between each node ID.

The probability $P$ of an attacker finding an hashkey that lands in the range with the range $(n,m)$ is 
$$ P \approx \frac{n-m}{H}\cdot num\_ips \cdot num\_ports  $$

making it equivalent to
$$ P \approx \frac{1}{N}\cdot num\_ips \cdot num\_ports  $$


The chances of compromising an entire network of N nodes that partition the entire network.
$$c \approx  1 - (1 -\frac{1}{N})^{num\_ips \cdot num\_ports}  $$

Alternatively, we can view this as doing a birthday attack in progress with different probabilities.
EG, we've generated $\frac{h}{N}$ values already, how many more do we need?


\section{Simulations}
Simulations were performed on a computer with consumer-grade budget hardware. 


\subsection{Experiment 1:Potatoing 2 random nodes}
Our initial experiment was designed to establish the feasability of injecting in between two random nodes.

Each trial, we generated two victims with random IP/port combinations, and an attacker with a random IP.
The experiment was for the attacker to find a hashkey in between the two victim's key, from the lowest to highest.

The amount of time to potato two random hashkeys was 29.6218323708 microseconds, and was achevied $ 99.996\%$ of the time.



\subsection{Experiment 2:  Nearest Neighbor Eclipse via Sybil}
The objective of the second experiment is to completely ensnare a network using a Sybil attack, starting with single node.


\subsection{Experiment 3: Fully Complete Eclipse via Sybil}
The previous experiments of

In some of the below frameworks, it is more efficient to perform an Eclipse attack by falsely advertising, rather than injecting





Any application built using a DHT must be address its vulnerabilities to the Eclipse and Sybil attacks

Security is not something that is thought about for a DHT, unless the 
DHT is specifically made to be secure against X.  
Or it's left to the applications



\subsubsection{Chord}
Most of the above attacks



Chances the finger is already covered:

\subsubsection{Kademlia}

\subsubsection{Plaxton Based networks}
More efficient to lie.


\section{Masking the Attack}
Now that we have established that a Sybil attack can be performed with great ease, our focus now turns to avoiding detection.

We need a different IP for each point surrounding our victim.  In the Nearest-Neighbor attack, we need a 

We can reduce this into an interesting graph coloring problem.


The hard maximum, in general, is $m$ seperate IP addresses, one for each bit in a $\log n$ routing/routing table DHT.
Recall that the vast


\section{Simple Load Balancing Injection Framework}

Costs:  Need to hold 15000ish hashkeys, effectily 160-bit numbers

\bibliography{potato}
\bibliographystyle{plain}
\end{document}
